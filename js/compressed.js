const modalSearchBtn=$(".search_btn"),serialNumberInput=$(".serialNumberInput"),quittanceInput=$(".quittanceInput"),unpInput=$(".unpInput"),modal=$(".modal"),errorMsg=$("#errorMsg"),dataTable=$(".tg"),btnPriceList=$(".btn_price-list"),url="/SGStemporary.xlsx",req=new XMLHttpRequest;req.open("GET",url,!0),req.responseType="arraybuffer",req.onload=function(){const a=new Uint8Array(req.response),b=XLSX.read(a,{type:"array",cellDates:!0,cellNF:!0,cellText:!1}),c=b.SheetNames,d=XLSX.utils.sheet_to_json(b.Sheets[c[0]]).filter(function(a){return currentDate=new Date(a.Date),periodStart=moment().endOf("month"),endPeriodMonth=moment(periodStart).subtract("2","months"),periodEnd=moment(endPeriodMonth).startOf("month"),periodStart.toDate().toLocaleDateString(),periodEnd.toDate().toLocaleDateString(),currentDate.toLocaleDateString(),currentDate<periodStart&&currentDate>periodEnd});modalSearchBtn.on("click",function(a){a.preventDefault();const b=d.filter(function(a){return a.SerialNumber===serialNumberInput.val()&&a.UNP===+unpInput.val()||a.QuittanceNumber===+quittanceInput.val()&&a.UNP===+unpInput.val()||a.QuittanceNumber===+quittanceInput.val()&&a.UNP===void 0});$("tr.rowData").html(""),0<b.length?(b.map(a=>{convertedDate=moment(a.Date).add("1","days").toDate().toLocaleDateString(),dataTable.append("<tr class=\"rowData\"><td>"+(a.QuittanceNumber?a.QuittanceNumber:"-")+"</td><td>"+(a.UNP?a.UNP:"-")+"</td><td>"+convertedDate+"</td><td>"+(a.DeviceName?a.DeviceName:"-")+"</td><td>"+(a.DeviceType?a.DeviceType:"-")+"</td><td>"+(a.SerialNumber?a.SerialNumber:"-")+"</td><td>"+(a.WorkStatus?a.WorkStatus:"-")+"</td><td>"+(a.RepairSummary?a.RepairSummary:"-")+"</td><td>"+(a.Docs?a.Docs:"-")+"</td></tr>")}),errorMsg.hide(),dataTable.show()):(dataTable.hide(),errorMsg.show(),errorMsg.html("\u0412\u0432\u0435\u0434\u0435\u043D\u043D\u0430\u044F \u043A\u043E\u043C\u0431\u0438\u043D\u0430\u0446\u0438\u044F \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430"))}),btnPriceList.on("click",function(){priceURL="/Price.pdf",$(location).attr("href",priceURL).attr("target","_blank")}),modal.on("hide.bs.modal",function(){serialNumberInput.val(""),quittanceInput.val(""),unpInput.val(""),dataTable.hide(),errorMsg.hide()}),$("input.search-input").keypress(function(a){if(13==a.which)return modalSearchBtn.click(),!1})},req.send();